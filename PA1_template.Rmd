---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

Load and analyze activity data, per assignment.

First, some basic setup:

- Load required libraries
- Set echo=TRUE (per assignment)

```{r setup}
library(knitr)
library(plyr)
library(dplyr)
opts_chunk$set(echo=TRUE)
```

## Loading and preprocessing the data
Read data from activity.csv into **steps**, extracting from ZIP file if necessary:

```{r extract}
files <- list.files()
if (! ("activity.csv" %in% files)) {
    unzip("activity.zip")
}

steps <- read.csv("activity.csv", as.is=TRUE)
steps$interval <- as.factor(sprintf("%04d", steps$interval))
#steps$pdate    <- as.POSIXlt(steps$date, format="%Y-%m-%d")
```

We also cast the interval as a factor that looks like "nnnn", and the date in POSIX format.

## What is mean total number of steps taken per day?

Aggregate the steps by day:

```{r stepsPerDay}
steps_by_day <- aggregate(x=steps[c("steps")], FUN="sum", by=list(Group.date=steps$date))
```

Histogram of same:

```{r dailyStepsHistogram}
hist(steps_by_day$steps, breaks=20, main="Frequency of Steps per Day", xlab="Steps in a Day")
```

Calculate mean and median steps per day:

```{r meanSteps}
mean_steps   <- mean(steps_by_day$steps, na.rm=TRUE)
median_steps <- median(steps_by_day$steps, na.rm=TRUE)
```

The mean number of steps per day is `r sprintf("%0.1f", mean_steps)`, and the median is `r median_steps`.

## What is the average daily activity pattern?

Break down steps by interval and plot:

```{r stepsByInterval}
steps_by_interval <- aggregate(steps ~ interval, steps, function(x) sum(x, na.rm=TRUE))

plot(steps_by_interval$interval,
     steps_by_interval$steps,
     type="l",
     main="Mean Steps through the Day",
     xlab="Five-Minute Interval",
     ylab="Steps")

# Lines don't seem to come out, so add this as backup.
lines(steps_by_interval$interval,
      steps_by_interval$steps)
```

Find the interval with the maximum number of steps:

```{r findMaxStepInterval}
max_steps <- max(steps_by_interval$steps)

max_interval <- steps_by_interval$interval[
    which.max(steps_by_interval$steps == max_steps)]
```

The interval with the highest number of steps, `r max_steps`,
begins at `r max_interval`.


## Imputing missing values

Count missing values:

```{r countMissingValues}
missing_value_count = sum(is.na(steps$steps))
```

There are `r missing_value_count` missing values in the original data set.


## Are there differences in activity patterns between weekdays and weekends?
